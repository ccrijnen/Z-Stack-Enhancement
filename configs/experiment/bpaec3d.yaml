# @package _global_

# to execute this experiment run:
# python scripts/train.py experiment=bpaec3d

defaults:
  - override /datamodule: bpaec3d_data.yaml
  - override /model: adain_unet_3d.yaml
  - override /callbacks: adain_callbacks.yaml
  - override /logger: tensorboard.yaml
  - override /trainer: ddp.yaml

trainer:
#  gpus: 2
  max_epochs: 500

datamodule:
#  dset: "nucleus"
#  dset: "actin"
  dset: "mitochondria"
#  dset: "all"
  resize_size: 448
  pad: 1
  batch_size: 1
  num_workers: 32
#  num_workers: 0

model:
  net:
#    unet_layers:  ['relu1_2', 'relu2_2', 'relu3_4', 'relu4_4', 'relu5_1']
#    style_layers: ['relu1_1', 'relu2_1', 'relu3_1', 'relu4_1', 'relu5_1']
    style_loss_fn: "gram"
  lr: 1e-4
#  weight_decay: 5e-4
#  lr_decay: 0.99
  style_weight: 1e6

seed: 42
name: bpaec/3d/${datamodule.dset}/unet/${model.net.style_loss_fn}_loss/lr:${model.lr}-lr_decay:${model.lr_decay}-style_weight:${model.style_weight}-weight_decay:${model.weight_decay}
#name: bpaec/3d/${datamodule.dset}/unet/${model.net.style_loss_fn}_loss/large_net/lr:${model.lr}-lr_decay:${model.lr_decay}-style_weight:${model.style_weight}-weight_decay:${model.weight_decay}

